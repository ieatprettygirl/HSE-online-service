# Проектирование и разработка REST API
## Цель работы: получить опыт проектирования программного интерфейса

# Часть № 1
**Зафиксировать принятые проектные решения (не менее 8) при проектировании API (оформить в виде документации с четким и подробным описанием в виде документа в md-формате). Использовать методы: GET, POST, PUT, DELETE.
(4 балла).**  
  
  
#### Работа с пользователями системы:
В ходе проектирования REST API для системы по подбору вакансий подросткам и обсуждения предлагаемых решений с научным руководителем и компанией было принято решение о хранение пользователей внутри базы данных. Кроме того, в системе будет сразу 2 роли стейкхолдера (Пользователь и Администратор) в 1 сущности **"users"**.  
  
1.1   
**Метод:** Post  
**Доступ:** Все пользователи.  
**Описание:** Зарегистрировать пользователя в системе с ролью "Пользователь".  
**URL-запроса:** http://localhost:8080/api/auth/register  
**Параметры запроса:** Обязательные поля ввода: login (логин), password (пароль), fullName (фио), age (возраст), token  
**Статус-коды HTTP:**  
• 201 Created: Ресурс был успешно создан.  
• 400 Bad Request: Ошибка в запросе клиента.   
• 500 Internal Server Error: Ошибка на стороне сервера.  
**Формат ответа:**  
• Json-объект (с информацией о статусе и полученным токеном при успешном создании).   
• Json-объект (обработанная ошибка: о существующем пользователе и статусе ответа).

1.2  
**Метод:** Post  
**Доступ:** Все пользователи.  
**Описание:** Войти в систему под своим аккаунтом.  
**URL-запроса:** http://localhost:8080/api/auth/login  
**Параметры запроса:** Обязательные поля ввода: login (логин), password (пароль), token    
**Статус-коды HTTP:**  
• 201 Created: Ресурс был успешно создан.  
• 400 Bad Request: Ошибка в запросе клиента.   
• 500 Internal Server Error: Ошибка на стороне сервера.  
**Формат ответа:**  
• Json-объект (с информацией о статусе и полученном токеном).  
• Json-объект (обработанная ошибка: неверный логин или пароль). 

1.3  
**Метод:** Get  
**Доступ:** Администратор.   
**Описание:** Получить информацию о всех пользователях системы.  
**URL-запроса:** http://localhost:8080/api/users   
**Параметры запроса:** token.    
**Статус-коды HTTP:**  
• 200 OK: Запрос успешно выполнен.  
• 401 Unauthorized: Необходима аутентификация.     
• 403 Forbidden: Доступ к ресурсу запрещён.  
**Формат ответа:**      
• Json-объект (с информацией о всех пользователях системы).  
• Json-объект (обработанная ошибка: необходимость аутентификации \ недостаточно прав доступа).  

1.4  
**Метод:** Get  
**Доступ:** Все аутентифицированные пользователи.  
**Описание:** Получить информацию о пользователе (только общедоступную).  
**URL-запроса:** http://localhost:8080/api/users/{id}   
**Параметры запроса:** "Id" пользователя в url, token  
**Статус-коды HTTP:**  
• 200 OK: Запрос успешно выполнен.  
• 401 Unauthorized: Необходима аутентификация.   
• 404 Not Found: Запрашиваемый ресурс не найден.   
**Формат ответа:**      
• Json-объект (с кастомной информацией о пользователе системы).  
• Json-объект (обработанная ошибка: необходимость аутентификации).  
• Json-объект (обработанная ошибка: запрашиваемый ресурс не найден). 

1.5  
**Метод:** Put  
**Доступ:** Аутентифицированный пользователь.  
**Описание:** Изменить информацию о себе (своём профиле).  
**URL-запроса:** http://localhost:8080/api/profile/{id}   
**Параметры запроса:** "Id" пользователя в url, token    
**Статус-коды HTTP:**  
• 200 OK: Запрос успешно выполнен, и данные были обновлены.  
• 400 Bad Request: Ошибка в запросе клиента. 
• 401 Unauthorized: Необходима аутентификация.  
• 403 Forbidden: Доступ к ресурсу запрещён.  
• 409 Conflict: Конфликт с текущим состоянием ресурса.   
• 500 Internal Server Error: Ошибка на стороне сервера.  
**Формат ответа:**      
• Json-объект (обновлённая информация и новый сгенерированный токен).  
• Json-объект (обработанная ошибка: необходимость аутентификации).  
• Json-объект (обработанная ошибка: доступ к ресурсу запрещен).  
• Json-объект (обработанная ошибка: запрашиваемый ресурс не найден). 

1.6  
**Метод:** Delete  
**Доступ:** Администратор.     
**Описание:** Удалить пользователя.  
**URL-запроса:** http://localhost:8080/api/users/{id}  
**Параметры запроса:** "Id" пользователя в url, token    
**Статус-коды HTTP:**  
• 200 OK: Запрос успешно выполнен, пользователь удалён.  
• 400 Bad Request: Ошибка в запросе клиента. 
• 401 Unauthorized: Необходима аутентификация.  
• 403 Forbidden: Доступ к ресурсу запрещён.  
• 404 Not Found: Запрашиваемый ресурс не найден.   
• 500 Internal Server Error: Ошибка на стороне сервера.  
**Формат ответа:**      
• Json-объект (со статусом об успешном удалении).  
• Json-объект (обработанная ошибка: необходимость аутентификации).  
• Json-объект (обработанная ошибка: информация об отсутствии).  
• Json-объект (обработанная ошибка: доступ к ресурсу запрещен).  
• Json-объект (обработанная ошибка: запрашиваемый ресурс не найден). 


#### Работа с компаниями:
Также в ходу проектирования было принято решение о независимой сущности, которая будет хранить информацию о компаниях, с которыми сотрудничает заказчик. Такое хранение необходимо для реализации хранения информации о будущих откликах, а также для удобства (информация пользователя и компании в корне отличается). Сущность для хранения компаний: **"companies"**.  

1.7  
**Метод:** Get  
**Доступ:** Администратор.      
**Описание:** Получить информацию о компаниях.  
**URL-запроса:** http://localhost:8080/api/v1/companies  
**Параметры запроса:** token.  
**Статус-коды HTTP:**  
• 200 OK: Запрос успешно выполнен.   
• 401 Unauthorized: Необходима аутентификация.  
• 403 Forbidden: Доступ к ресурсу запрещён.  
• 404 Not Found: Запрашиваемый ресурс не найден.   
• 500 Internal Server Error: Ошибка на стороне сервера.  
**Формат ответа:**      
• Json-объект (со статусом об успешном удалении).  
• Json-объект (обработанная ошибка: необходимость аутентификации).  
• Json-объект (обработанная ошибка: информация об отсутствии).  
• Json-объект (обработанная ошибка: доступ к ресурсу запрещен).  
• Json-объект (обработанная ошибка: запрашиваемый ресурс не найден). 


1.8  
**Метод:** Post  
**Доступ:** Администратор.     
**Описание:** Добавить компанию.  
**URL-запроса:** http://localhost:8080/api/v1/companies  
**Параметры запроса:** token, login (логин), password (пароль), inn(ИНН), kpp (КПП), ogrn (ОГРН), address (адресс), director (директор), dateRegister (Дата регистрации).  
**Статус-коды HTTP:**  
• 201 Created: Ресурс был успешно создан.  
• 400 Bad Request: Ошибка в запросе клиента.   
• 401 Unauthorized: Необходима аутентификация.  
• 403 Forbidden: Доступ к ресурсу запрещён.   
• 500 Internal Server Error: Ошибка на стороне сервера.  
**Формат ответа:**      
• Json-объект (со статусом об успешном удалении).  
• Json-объект (обработанная ошибка: необходимость аутентификации).   
• Json-объект (обработанная ошибка: доступ к ресурсу запрещен).  


1.9  
**Метод:** Put  
**Доступ:** Администратор, компания.     
**Описание:** Обновить информацию о компании.  
**URL-запроса:** http://localhost:8080/api/v1/companies/{id}  
**Параметры запроса:** "Id" пользователя в url, token.    
**Статус-коды HTTP:**  
• 200 OK: Запрос успешно выполнен, и данные были обновлены.  
• 400 Bad Request: Ошибка в запросе клиента.  
• 401 Unauthorized: Необходима аутентификация.  
• 403 Forbidden: Доступ к ресурсу запрещён.  
• 409 Conflict: Конфликт с текущим состоянием ресурса.   
• 500 Internal Server Error: Ошибка на стороне сервера.  
**Формат ответа:**      
• Json-объект (обновлённая информация и новый сгенерированный токен).  
• Json-объект (обработанная ошибка: необходимость аутентификации).  
• Json-объект (обработанная ошибка: доступ к ресурсу запрещен).  
• Json-объект (обработанная ошибка: запрашиваемый ресурс не найден). 

1.10  
**Метод:** Delete  
**Доступ:** Администратор.     
**Описание:** Удалить компанию.  
**URL-запроса:** http://localhost:8080/api/v1/companies/{id}  
**Параметры запроса:** "Id" пользователя в url  
**Статус-коды HTTP:**  
• 200 OK: Запрос успешно выполнен, компания удалена.  
• 400 Bad Request: Ошибка в запросе клиента.   
• 401 Unauthorized: Необходима аутентификация.  
• 403 Forbidden: Доступ к ресурсу запрещён.  
• 404 Not Found: Запрашиваемый ресурс не найден.   
• 500 Internal Server Error: Ошибка на стороне сервера.  
**Формат ответа:**      
• Json-объект (со статусом об успешном удалении).  
• Json-объект (обработанная ошибка: необходимость аутентификации).  
• Json-объект (обработанная ошибка: информация об отсутствии).  
• Json-объект (обработанная ошибка: доступ к ресурсу запрещен).  
  
    
# Часть № 2

### Реализовать соответствующий API (c методами GET, POST). Количество методов не менее 6 (2 балла).  

**Ниже будет представлена имеющаяся на данный момент архитектура REST API (с реализованными около 15 методами), а также реализация запросов в контроллерах.**

![alt text](resources/restApiPicture.png)

1.1  Регистрация в системе (role создаётся "Пользователь").  

![alt text](resources/resisterMethod.png)

Функция регистрации пользователя с шифрованием пароля и получением токена.   

![alt text](resources/registerFunction.png)

1.2  Авторизация в системе. 

![alt text](resources/loginMethod.png)  


Функция авторизации пользователя с проверкой пароля (хеши) и получением токена.

![alt text](resources/loginFunction.png)

1.3 Получение информации (полной) о всех пользователях системы.

![alt text](resources/GetAllUsersMethod.png)  

1.4 Получение информации о пользователе (только общедоступную).

![alt text](resources/GetCustomInfAboutUser.png)

1.5 Изменение (обновление) информации о своём профиле.

![text](resources/ChangeInfoProfile.png)

1.6 Удаление пользователя из системы.

![alt text](resources/DeleteUser.png)

1.7 Получение информации о компаниях.

![alt text](resources/GetCompaniesInfo.png)

1.8 Добавление компании в систему (role_id = 3).

![alt text](resources/CreateCompany.png)

1.9 Обновление информации о компании.

![alt text](resources/UpdateInfoCompany.png)  

1.10 Удаление компании из системы.  

![alt text](resources/DeleteCompany.png)

# Часть № 3
## + дополнительное задание (2 метода "put" и 2 метода "delete", описанные ранее)
### Протестировать API при помощи Postman (дополнить отчетный документ из п.1 результатами тестирования, сопроводив принтскринами из Postman). Минимум 2 теста на каждый Endpoint (2 балла).  

### 1.1  Регистрация в системе.  

1.1.1 Создание пользователя без обязательных полей (login и fullName).  

![text](resources/postman/1.png)

1.1.2 Создание пользователя с уже существующим логином.  

![text](resources/postman/2.png)

1.1.3 Успешное создание пользователя.  

![text](resources/postman/3.png)

1.2.1 Авторизация в системе (без пароля). 

![text](resources/postman/4.png)

1.2.2 Авторизация в системе с несуществующими данными. 

![text](resources/postman/5.png) 

1.2.3 Успешная авторизация в системе.

![text](resources/postman/6.png) 

1.3.1 Получение пользователей от имени обычного пользователя. 

![text](resources/postman/7.png) 

1.3.2 Получение пользователей от имени администратора. 

![text](resources/postman/8.png) 

1.4.1 Получение информации (общедоступной) о несуществующем пользователе.

![alt text](resources/postman/9.png)

1.4.2 Успешное получение информации (общедоступной) о пользователе.

![alt text](resources/postman/10.png)

1.4.3 Получение информации (общедоступной) с несуществующим токеном.

![alt text](resources/postman/11.png)

1.5.1  Обновление информации о несуществующем профиле.

![alt text](resources/postman/12.png)

1.5.2  Обновление информации о чужом профиле.

![alt text](resources/postman/13.png)

1.5.3  Изменение логина на существующий.

![alt text](resources/postman/14.png)

1.5.4  Успешное обновление профиля.

![alt text](resources/postman/15.png)

1.6.1  Удаление несуществующего пользователя из системы.

![alt text](resources/postman/16.png)

1.6.2  Удаление своего профиля из системы.

![alt text](resources/postman/17.png)

1.6.3  Успешное удаление пользователя.

![alt text](resources/postman/18.png)

1.7.1 Получение информации о компаниях от имени обычного пользователя.

![alt text](resources/postman/19.png)

1.7.2 Получение информации о компаниях от имени администратора.

![alt text](resources/postman/20.png)

1.8.1 Добавление компании в систему без параметров.

![alt text](resources/postman/21.png)

1.8.2 Добавление компании в систему от имени обычного пользователя.

![alt text](resources/postman/22.png)

1.8.3 Добавление представителя компании в систему администратором с существующим логином.

![alt text](resources/postman/23.png)

1.8.4 Успешное добавление представителя компании в систему администратором.

![alt text](resources/postman/24.png)

1.9.1 Обновление информации о несуществующей компании.

![alt text](resources/postman/25.png)

1.9.2 Успешное обновление информации о компании.

![alt text](resources/postman/26.png)

1.10.1 Удаление компании из системы обычным пользователем. 

![alt text](resources/postman/27.png)

1.10.2 Удаление несуществующей компании из системы администратором. 

![alt text](resources/postman/28.png)

1.10.3 Успешное удаление компании из системы администратором. 

![alt text](resources/postman/29.png)
